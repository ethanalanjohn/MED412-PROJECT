from machine import Pin, PWM
import time

# Define the GPIO pin connected to the servo's signal pin
servo_pin = 15  # Update this to the correct GPIO pin for the servo

# Set up PWM for the servo motor
servo = PWM(Pin(servo_pin))
servo.freq(50)  # Standard frequency for servo motors (50 Hz)

# Function to set the servo position (0 to 90 degrees)
def set_servo_angle(angle):
    """ Set the servo motor to a specific angle. """
    min_duty = 1000  # Minimum duty cycle (0 degrees)
    max_duty = 9000  # Maximum duty cycle (90 degrees)

    # Map the angle (0-90) to the PWM duty cycle
    duty = int(min_duty + (angle / 90) * (max_duty - min_duty))
    servo.duty_u16(duty)

def launch_projectile():
    """ Rotate the arm from 0 to 90 degrees to launch the projectile. """
    print("Launching projectile...")

    # Set the servo to 0 degrees (starting position)
    set_servo_angle(0)
    time.sleep(1)  # Wait for the servo to reach the position (can adjust this for actual servo speed)

    # Rotate the arm to 90 degrees as quickly as possible
    set_servo_angle(90)  # Set to 90 degrees to launch
    time.sleep(1)  # Wait for the servo to complete the motion (adjust as necessary)

    print("Projectile launched!")

# Test the launch function
try:
    launch_projectile()

except KeyboardInterrupt:
    print("Program interrupted")
    servo.deinit()  # Clean up the servo control
